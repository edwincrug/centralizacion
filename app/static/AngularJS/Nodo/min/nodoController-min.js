registrationModule.controller("nodoController",function(e,o,r,n,t,a,i,c){e.isLoading=!1,e.idProceso=1,e.perfil=1;var l=function(e,o,r,t){$("#btnEnviar").button("reset"),n.error("Ocurrio un problema")};e.init=function(){u(),c.get(o.currentEmployee).success(d).error(l)},o.CargaEmpleado=function(r){u(),e.id=r,c.get(o.currentEmployee).success(d).error(l)};var u=function(){if(""!=getParameterByName("employee")&&(o.currentEmployee=getParameterByName("employee")),null==o.currentEmployee){var e=prompt("Ingrese un número de empleado",1);o.currentEmployee=e}},d=function(r,a,i,c){o.empleado=r,null!=o.empleado?(e.folio=""!=getParameterByName("id")?getParameterByName("id"):e.id,e.folio?t.getHeader(e.folio,o.empleado.idUsuario).success(s).error(l):$("#slide").click()):n.error("El empleado no existe en el sistema.")},s=function(r,a,i,c){e.expediente=r,null!=e.expediente?t.getAll(e.folio,e.idProceso,o.empleado.idPerfil).success(p).error(l):n.error("No existe información para este expediente.")};e.VerOrdenPadre=function(e){location.href="/?id="+e.folioPadre+"&employee=1"},e.VerOrdenHijo=function(e){location.href="/?id="+e.folioHijo+"&employee=1"};var p=function(o,r,n,t){e.listaNodos=o,e.numElements=o.length,f(),setTimeout(function(){$("ul#standard").roundabout({btnNext:".next",btnNextCallback:function(){m(".next")},btnPrev:".prev",btnPrevCallback:function(){m(".prev")},clickToFocusCallback:function(){m(".next")}}),g(e.currentPage)},1)},f=function(){e.currentPage=e.expediente.nodoActual},m=function(o){e.currentPage=$("ul#standard").roundabout("getChildInFocus")+1,0!=e.listaNodos[e.currentPage-1].enabled?g(e.currentPage):(n.warning("El nodo "+e.currentPage+" no está disponible para su perfil."),$(o).click())};e.setPage=function(o){0!=o.enabled?(e.currentPage=o.id,g(e.currentPage)):n.warning("Nodo "+e.currentPage+" no disponible para su perfil.")};var g=function(o){$("ul#standard").roundabout("animateToChild",o-1),e.currentNode=e.listaNodos[o-1],P(),y()},P=function(){angular.forEach(e.listaNodos,function(o,r){r==e.currentPage-1?o.active=1:o.active=0}),v()},N=function(o,r,n,t){e.isLoading=!1,e.listaAlertas=o,v()},b=function(o,r,n,t){e.listaDocumentos=o,i.getByNodo(e.idProceso,e.currentNode.id,e.currentNode.folio).success(N).error(l)},y=function(){1!=e.currentNode.estatus?(e.isLoading=!0,v(),a.getByNodo(e.currentNode.id,e.currentNode.folio,e.perfil).success(b).error(l)):n.warning("El nodo "+e.currentNode.id+" aún no se activa para el expediente actual. No existen documentos para mostrar.")},v=function(){"$apply"!=e.$root.$$phase&&"$digest"!=e.$root.$$phase&&e.$apply()}});