registrationModule.controller("documentoController",function(e,o,i,a,n){var t=function(e,o,i,n){$("#btnEnviar").button("reset"),a.error("Ocurrio un problema")};e.VerDocumento=function(i){if(1==i.consultar)if(14==i.idDocumento)e.folioActual=i.folio,n.getDocsByFolio(i.folio).success(c).error(t);else{var r=i.existeDoc,l=o.obtieneTypeAplication(r),u=i.folio+" :: "+i.descripcion,s='<div id="hideFullContent"><div id="hideFullMenu" onclick="nodisponible()" ng-controller="documentoController"> </div> <object id="ifDocument" data="'+r+'" type="'+l+'" width="100%" height="100%"><p>Alternative text - include a link <a href="'+r+'">to the PDF!</a></p></object> </div>';$.createModal({title:u,message:s,closeButton:!1,scrollable:!1})}else a.warning("Acción no permitida para su perfil.")},o.obtieneTypeAplication=function(e){var o=e.split("."),i="application/pdf";switch(o[o.length-1].toLowerCase()){case"jpg":i="image/jpeg";break;case"png":i="image/png";break;case"gif":i="image/gif";break;case"jpeg":i="image/jpeg"}return i},e.NoDisponible=function(){a.error("Función deshabilitada en digitalización.")},e.ShowEnviar=function(e){1==e.enviarEmail?($("#modalSend").modal("show"),o.currentDocument=e):a.warning("Acción no permitida para su perfil.")};var r=function(e,o,i,n){a.success("Documento enviado correctamente."),$("#btnEnviar").button("reset"),$("#modalSend").modal("hide")},c=function(e,o,i,a){var n='<div id="hideFullContent"><div><ul class="nav nav-tabs"> ';angular.forEach(e,function(e,o){n=0==o?n+'<li class="active"><a data-toggle="tab" href="#divMenu'+o+'" target="_self">Póliza '+(o+1)+" </a></li>":n+'<li><a data-toggle="tab" href="#divMenu'+o+'" target="_self">Póliza '+(o+1)+" </a></li>"}),n+='</ul></div> <div class="tab-content">',angular.forEach(e,function(e,o){n=0==o?n+'<div class="tab-pane active" id="divMenu'+o+'"><iframe src="'+e+'" width="560" height="350" allowfullscreen="allowFullScreen"></iframe></div>':n+'<div class="tab-pane" id="divMenu'+o+'"><iframe src="'+e+'" width="560" height="350" allowfullscreen="allowFullScreen"></iframe></div>'}),n+="</div></div>",$.createModal({title:"Pólizas de Transferencia",message:n,closeButton:!1,scrollable:!1})};e.EnviarDocumento=function(){1==o.currentDocument.consultar?($("#btnEnviar").button("loading"),n.sendMail(o.currentDocument.idDocumento,o.currentDocument.folio,e.correoDestinatario).success(r).error(t)):a.warning("Acción no permitida para su perfil.")},e.openUpload=function(){var i={idProceso:1,idNodo:2,nombreNodo:"",folio:o.currentFolioFactura,nombreDocumento:"",idDocumento:15,origen:"",descripcion:"",idPerfil:"",consultar:"",imprimir:"",enviarEmail:"",descargar:"",cargar:"",estatusNombre:"",idEstatus:"",Ruta:"",existeDoc:""};e.ShowCargar(i)},e.ShowCargar=function(e){15==e.idDocumento?location.href="/factura?id="+e.folio+"&employee="+o.currentEmployee:($("#frameUpload").attr("src","/uploader"),$("#modalUpload").modal("show"),o.currentUpload=e)};var l=function(e,o,i,n){a.success("Documento cargado")};e.CargarDocumento=function(){n.uploadFile($("#fileDoc")[0].files[0]).success(l).error(t)},e.FinishUpload=function(e){a.success("Se guardo el documento "+e);var i=o.currentUpload;n.saveDocument(i.folio,i.idDocumento,1,1,i.idNodo,1,global_settings.uploadPath+"/"+e).success(u).error(t)};var u=function(e,i,n,t){a.success("Documento guardado.");var r=window.location.pathname;"/Factura"==r?o.muestraDocumentos():setTimeout(function(){o.LoadActiveNode()},200)}});